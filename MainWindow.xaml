<Window
    x:Class="Launchbox.MainWindow"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:local="using:Launchbox"
    xmlns:helpers="using:Launchbox.Helpers"
    xmlns:models="using:Launchbox.Models"
    xmlns:media="using:Microsoft.UI.Xaml.Media"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    xmlns:tb="using:H.NotifyIcon"
    mc:Ignorable="d">

    <Grid x:Name="RootGrid" Background="Transparent">
        <Grid.Resources>
            <helpers:BooleanToVisibilityConverter x:Key="BooleanToVisibilityConverter" />
        </Grid.Resources>

        <tb:TaskbarIcon x:Name="TrayIcon"
                        ToolTipText="Launchbox (Alt+S)"
                        IconSource="/Assets/Square44x44Logo.targetsize-24_altform-unplated.png"
                        LeftClickCommand="{Binding ViewModel.ToggleWindowCommand}"
                        DoubleClickCommand="{Binding ViewModel.ToggleWindowCommand}">
            <tb:TaskbarIcon.ContextFlyout>
                <MenuFlyout>
                    <MenuFlyoutItem Text="Show" Command="{Binding ViewModel.ToggleWindowCommand}">
                        <MenuFlyoutItem.Icon>
                            <SymbolIcon Symbol="View" />
                        </MenuFlyoutItem.Icon>
                    </MenuFlyoutItem>
                    <MenuFlyoutItem Text="Settings" Command="{Binding ViewModel.OpenSettingsCommand}">
                        <MenuFlyoutItem.Icon>
                            <SymbolIcon Symbol="Setting" />
                        </MenuFlyoutItem.Icon>
                    </MenuFlyoutItem>
                    <MenuFlyoutSeparator />
                    <MenuFlyoutItem Text="Exit" Command="{Binding ViewModel.ExitCommand}">
                        <MenuFlyoutItem.Icon>
                            <SymbolIcon Symbol="Cancel" />
                        </MenuFlyoutItem.Icon>
                    </MenuFlyoutItem>
                </MenuFlyout>
            </tb:TaskbarIcon.ContextFlyout>
        </tb:TaskbarIcon>

        <StackPanel x:Name="EmptyStatePanel"
                    x:Load="{x:Bind ViewModel.IsEmpty, Mode=OneWay}"
                    HorizontalAlignment="Center"
                    VerticalAlignment="Center"
                    Spacing="12">
            <SymbolIcon Symbol="Folder" RenderTransformOrigin="0.5,0.5"
                        AutomationProperties.AccessibilityView="Raw">
                <SymbolIcon.RenderTransform>
                    <ScaleTransform ScaleX="2" ScaleY="2"/>
                </SymbolIcon.RenderTransform>
            </SymbolIcon>
            <TextBlock Text="No shortcuts found"
                       FontSize="16"
                       FontWeight="SemiBold"
                       HorizontalAlignment="Center"/>
            <TextBlock Text="Add shortcuts to your Desktop/Shortcuts folder"
                       Foreground="{ThemeResource TextFillColorSecondaryBrush}"
                       HorizontalAlignment="Center"/>
            <Button Command="{x:Bind ViewModel.OpenShortcutsFolderCommand}"
                    HorizontalAlignment="Center"
                    Style="{ThemeResource AccentButtonStyle}"
                    Margin="0,8,0,0"
                    AutomationProperties.Name="Open Shortcuts Folder">
                <StackPanel Orientation="Horizontal" Spacing="8">
                    <SymbolIcon Symbol="Folder" />
                    <TextBlock Text="Open Shortcuts Folder" />
                </StackPanel>
            </Button>
        </StackPanel>

        <GridView x:Name="AppGrid" 
                  Padding="20"
                  Background="Transparent"
                  SelectionMode="None" 
                  IsItemClickEnabled="True" 
                  ItemClick="AppGrid_ItemClick"
                  ScrollViewer.VerticalScrollBarVisibility="Auto"
                  ScrollViewer.VerticalScrollMode="Enabled"
                  ScrollViewer.IsVerticalRailEnabled="True">

            <GridView.ItemContainerStyle>
                <Style TargetType="GridViewItem">
                    <Setter Property="CornerRadius" Value="8"/>
                    <Setter Property="Margin" Value="4"/>
                    <Setter Property="Padding" Value="4"/>
                    <Setter Property="HorizontalContentAlignment" Value="Stretch"/>
                    <Setter Property="VerticalContentAlignment" Value="Stretch"/>
                </Style>
            </GridView.ItemContainerStyle>

            <GridView.ItemTemplate>
                <DataTemplate x:DataType="models:AppItem">
                    <StackPanel Width="110" Height="130" Spacing="4" 
                                HorizontalAlignment="Center" 
                                VerticalAlignment="Center"
                                ToolTipService.ToolTip="{x:Bind Name}"
                                AutomationProperties.Name="{x:Bind Name}">

                        <Image Source="{x:Bind (media:ImageSource)Icon, Mode=OneWay}" Width="56" Height="56" Margin="0,10,0,0" AutomationProperties.AccessibilityView="Raw" x:Phase="1"/>

                        <TextBlock Text="{x:Bind Name}" 
                                   TextAlignment="Center" 
                                   TextWrapping="Wrap" 
                                   MaxLines="3"
                                   TextTrimming="CharacterEllipsis"
                                   FontSize="12"
                                   FontWeight="SemiBold"/>
                    </StackPanel>
                </DataTemplate>
            </GridView.ItemTemplate>
        </GridView>
    </Grid>
</Window>